# Copilot Instructions for Test Automation Framework

## Overview
This is a comprehensive test automation framework using Maven, Cucumber, Java, Selenium, TestNG, RestAssured, Allure, and Logback. It supports UI and API testing with parallel execution, environment-specific configurations, thread-specific logging, and detailed reporting.

## General Guidelines
- Always use OpenJDK 17+ for Java development.
- Follow Maven standard directory structure.
- Use logical package naming under `com.automation.framework`.
- Prefer soft assertions in Cucumber BDD tests to report failures at the end of scenarios.
- Use hard assertions only when functionality cannot proceed (e.g., critical setup failures).
- Use Google Guice for dependency injection to manage shared dependencies like WebDriver and TestContext.

## Test Writing
- **UI Tests**: Use Selenium with WebDriverManager for automatic driver setup. Implement in `src/test/resources/features/ui/` with step definitions in `com.automation.framework.steps.ui`. Use Page Object Model in `com.automation.framework.pages`.
- **API Tests**: Use RestAssured for HTTP requests. Implement in `src/test/resources/features/api/` with step definitions in `com.automation.framework.steps.api`.
- **Cucumber Features**: Write in Gherkin syntax. Use placeholders initially, then implement real scenarios.
- **Parallel Execution**: Tests run in parallel by default (3 threads via testng.xml). Ensure thread-safety in step definitions.
- **Assertions**: Use TestNG soft asserts in step methods. Call `softAssert.assertAll()` in `@Then` steps.
- **Data Sharing**: Use `TestContext` for thread-safe data sharing across steps.
- **Retry Mechanism**: Failed tests are retried automatically based on `retry.count` in global.properties.

## Configuration
- **Properties**: Global properties in `src/test/resources/config/global.properties`. Environment-specific in `dev.properties`, `qa.properties`, etc.
- **Environments**: Specify via Maven profile (e.g., `mvn test -Pdev`). Properties load global first, then override with env-specific.
- **Logging**: Uses Logback with MDC for thread-specific logs. Logs saved to `logs/{testName}.log` and attached to Allure reports.
- **TestNG**: Configured via `src/test/resources/testng.xml` for suite setup and parallel execution.

## Dependencies
- Selenium: For UI automation with WebDriverManager.
- RestAssured: For API testing with automatic request/response logging.
- Cucumber: For BDD with TestNG integration.
- TestNG: For test execution, soft assertions, and retry mechanism.
- Allure: For detailed reporting with attached screenshots, logs, and API details.
- Logback: For logging with per-test log files.
- Google Guice: For dependency injection.

## Running Tests
- Compile: `mvn clean compile`
- Run all tests: `mvn clean test -P<env>` (e.g., `-Pdev`)
- Run specific suite: Modify `testng.xml` or use TestNG groups/Cucumber tags.
- Reports: Allure via `mvn allure:report` and `mvn allure:serve`.
- Logs: View in `logs/` folder or attached in Allure reports.

## Best Practices
- Keep step definitions reusable and parameterized.
- Use Page Object Model for UI tests (create classes in `com.automation.framework.pages`).
- Handle waits with WebDriverWait for UI stability.
- Validate API responses with JSON assertions or schemas.
- Log important actions using `LoggerUtil.getLogger(Class.class).info("message")`.
- Ensure tests are idempotent and independent.
- Attach screenshots and logs automatically via Allure.

## Adding New Tests
1. Add feature file in appropriate folder.
2. Implement step definitions with soft asserts and logging.
3. Update runners if needed.
4. Run and verify in parallel.

## Troubleshooting
- If WebDriver fails, ensure WebDriverManager is set up and Chrome is installed.
- For API issues, check RestAssured logs and Allure attachments.
- Parallel issues: Check thread-safety, TestContext usage, and MDC clearing.
- Property overrides: Verify env profile and file loading order.
- Logging issues: Ensure MDC is set/cleared properly and logback.xml is configured.

This framework is designed for scalability and maintainability in automated testing.